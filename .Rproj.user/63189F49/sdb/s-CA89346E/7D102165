{
    "collab_server" : "",
    "contents" : "\n---\ntitle: \"SPIA-PCC: Signaling pathway impact analysis incorporated the change of Pearson correlation coefficient between two groups\"\nauthor: \"Xianbin Li\"\ndate: '`r Sys.Date()`'\noutput:\n  pdf_document: default\n  html_document: default\n  word_document: default\nvignette: |\n  %\\VignetteIndexEntry{narray Usage Examples} %\\VignetteEngine{knitr::rmarkdown} %\\VignetteEncoding{UTF-8}\n---\n\n```{r setup, echo=FALSE, results='hide', warning=FALSE, error=FALSE, message=FALSE, cache=FALSE}\nlibrary(knitr)\nopts_chunk$set(\n  cache = FALSE,\n  echo = TRUE,\n  warning = FALSE,\n  error = FALSE,\n  message = FALSE\n)\n```\n\nspiapcc pathway signatures\n==========================\n\nThis R package provides  function that uses the previous SPIA method and integrate the change of genes Pearson coefficient(PCC) from two groups. We proposed a set of three pathway analysis methods based on the change of PCC. We applied these approaches to colorectal cancer, lung cancer and Alzheimer's disease datasets and so on.\n\nScoring the `KEGGandMetacoreDzPathwaysGEO` package data for pathway analysis\n----------------------------------------------------\n\nThis is to outline how to prepare expression data, in this case from the\n`KEGGandMetacoreDzPathwaysGEO` package for pathway  analysis using spiap.\n\n### Preparing the gene expression matrix\n\n```{r}\nlibrary(EnrichmentBrowser)\nlibrary(KEGGandMetacoreDzPathwaysGEO)\nlibrary(KEGGdzPathwaysGEO)\nlibrary(SPIA)\n\n# load the dateset\ndata(\"GSE1145\")\n# get the gene expression matrix\nexprs_all <- exprs(GSE1145)\n# get the gene symbol of gene expression matrix\nall.eset <- probe.2.gene.eset(GSE1145)\nhead(featureNames(all.eset))\n\n\n# Normalization of gene expression profile\nbefore.norm <- exprs(all.eset)\nall.eset <- normalize(all.eset, norm.method=\"quantile\")\nafter.norm <- exprs(all.eset)\n\n# Change matrix to dataframe style\nexprs_all1 <- data.frame(after.norm)\n\n# plot of normalization\npar(mfrow=c(1,2))\nboxplot(before.norm)\nboxplot(after.norm)\n```\n\n### Obtaining case and control samples\n\n```{r}\ntable(pData(all.eset)$Group)\npData(all.eset)$GROUP <- ifelse(pData(all.eset)$Group == \"d\", 1, 0)\nnormal <- length(which(pData(all.eset)$GROUP == '0'))\ntumor <- length(which(pData(all.eset)$GROUP == '1'))\n\n```\n\n### Get differential expression genes\n\n```{r}\n# get differential expression genes\nall.eset <- de.ana(all.eset)\nhead(fData(all.eset), n=4)\nall_de <- fData(all.eset)\n\n#The plot of differential expression genes \npar(mfrow=c(1,2))\npdistr(fData(all.eset)$ADJ.PVAL)\nvolcano(fData(all.eset)$FC, fData(all.eset)$ADJ.PVAL)\n\n```\n\n### Get database of signaling pathways from KEGG\n\n```{r}\n# get pathway dataset\nkegg.gs <- get.kegg.genesets(\"hsa\")\n\n```\n\n### Get the results of SPIA method and spiap method, we use colorectal  cancer dataset from GSE8671 \n\n```{r}\nlibrary(spiapcc)\n\n# get differential expression genes on threshold 0.1\ntg <- all_de[all_de$ADJ.PVAL < 0.1,]\n# get fold change pf differential expression genes\nDE_colorectal = tg$FC\nnames(DE_colorectal)<-as.vector(rownames(tg))\n# get all gene names\nALL_colorectal = rownames(all_de)\n#The result of spia method\nres_spia = spia(de = DE_colorectal, all=ALL_colorectal, organism=\"hsa\",nB=2000,plots=FALSE,beta=NULL,combine=\"fisher\",verbose=TRUE)\nres_spia <- res_spia[,-12]\nhead(res_spia)\ngse_madat2 <- exprs_all1\n\n# The results of spia_nt method\nres_nt = spiapcc(de=DE_colorectal, all=ALL_colorectal,normal = normal,tumor = tumor,  gse_madat2 = gse_madat2,organism=\"hsa\",nB=2000,plots=FALSE,\n                   beta=NULL,combine=\"fisher\",verbose=T, flag = 1)\nres_nt <- res_nt[,-12]\nhead(res_nt)\n\n#The results of spia_tn method\nres_tn = spiapcc( de=DE_colorectal, all=ALL_colorectal,normal = normal,tumor = tumor,  gse_madat2 = gse_madat2,organism=\"hsa\",nB=2000,plots=FALSE,\n                   beta=NULL,combine=\"fisher\",verbose=T, flag = -1)\nres_tn <- res_tn[,-12]\nhead(res_tn)\n\n#The results of spia_abs method\nres_abs = spiapcc( de=DE_colorectal, all=ALL_colorectal,normal = normal,tumor = tumor,  gse_madat2 = gse_madat2,organism=\"hsa\",nB=2000,plots=FALSE,\n                   beta=NULL,combine=\"fisher\",verbose=T, flag = 0)\nres_abs <- res_abs[,-12]\nhead(res_abs)\n\n```\n\n```{r}\n# \ndata(\"GSE3467\")\nresult <- process(GSE3467)\nexprs_nrom <- result$exprs\nnormal <- result$normal\ntumor <- result$tumor\nDE <- result$DE\nALL <- result$ALL\n\nres = spiapcc( de=DE, all=ALL,normal = normal,tumor = tumor,  gse_madat2 = exprs_nrom, organism=\"hsa\",nB=2000,plots=FALSE,\n                   beta=NULL,combine=\"fisher\",verbose=T, flag = 0)\nres <- res[,-12]\nhead(res)\n\n\n```\nR version information\n---------------------\n\n```{r echo=FALSE}\nsessionInfo()\n```\n",
    "created" : 1539825771029.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1360696841",
    "id" : "7D102165",
    "lastKnownWriteTime" : 1539827637,
    "last_content_update" : -2147483648,
    "path" : "C:/Users/lxb/Desktop/spiapcc/vignettes/spiapcc.Rmd",
    "project_path" : "vignettes/spiapcc.Rmd",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}